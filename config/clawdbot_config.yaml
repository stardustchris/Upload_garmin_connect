# Configuration Clawdbot pour Garmin Automation
# √Ä int√©grer dans la config Clawdbot principale

# Connexion Google Drive
google_drive:
  folder_id: "1pl25O92YdeAP_v1NBVGlzwCfPtuLKg4P"
  credentials_path: "~/.config/clawdbot/google_credentials.json"

# R√®gles de traitement email
email_rules:
  - name: "Entra√Ænements St√©phane Palazzetti"
    sender: "stephane.palazzetti@*"  # √Ä remplacer par l'email exact

    attachments:
      - pattern: "S√©ances S*.pdf"
        action:
          type: "save_and_execute"
          destination: "google_drive"  # Sauvegarder sur Drive
          script: "~/Documents/Triathlon/garmin_automation/scripts/clawdbot_workflow.py"
          args:
            - "--action"
            - "upload_workouts"
            - "--file"
            - "{attachment_path}"
          notification:
            title: "‚úÖ Entra√Ænements upload√©s"
            message: "Semaine {week} upload√©e sur Garmin Connect"

      - pattern: "S*_carnet*.xls"
        action:
          type: "save_only"
          destination: "google_drive"
          notification:
            title: "üìä Carnet Excel re√ßu"
            message: "Pr√™t pour remplissage dimanche 22h"

# T√¢ches planifi√©es (cron-like)
scheduled_tasks:
  - name: "Remplissage carnet hebdomadaire"
    schedule: "0 22 * * 0"  # Dimanche 22:00
    action:
      type: "execute_script"
      script: "~/Documents/Triathlon/garmin_automation/scripts/clawdbot_workflow.py"
      args:
        - "--action"
        - "fill_excel"
        - "--file"
        - "{latest_xls_from_drive}"  # R√©cup√®re le dernier XLS
      notification:
        title: "üìä Carnet rempli"
        message: "Pr√™t pour relecture sur Google Drive"

      on_success:
        # Uploader le XLSX rempli sur Drive (remplace le XLS)
        upload_to_drive: true
        drive_folder_id: "1pl25O92YdeAP_v1NBVGlzwCfPtuLKg4P"

# Commandes manuelles
manual_commands:
  - name: "prepare_email"
    trigger: "!prepare-email S07"  # Commande Clawdbot
    description: "Pr√©pare l'email pour St√©phane avec le carnet rempli"
    action:
      type: "execute_script"
      script: "~/Documents/Triathlon/garmin_automation/scripts/clawdbot_workflow.py"
      args:
        - "--action"
        - "prepare_email"
        - "--file"
        - "{week}_carnet_entrainement.xlsx"
      notification:
        title: "üìß Email pr√©par√©"
        message: "Brouillon pr√™t - Relis et envoie manuellement"

# Notifications
notifications:
  channels:
    - type: "macos"  # Notifications macOS
      enabled: true
    - type: "telegram"  # Optionnel
      enabled: false
      bot_token: "YOUR_BOT_TOKEN"
      chat_id: "YOUR_CHAT_ID"
    - type: "email"  # Optionnel
      enabled: false
      recipient: "your_email@example.com"

# Logs
logging:
  level: "INFO"
  file: "~/Documents/Triathlon/garmin_automation/logs/clawdbot_automation.log"
  max_size: "10MB"
  backup_count: 5
