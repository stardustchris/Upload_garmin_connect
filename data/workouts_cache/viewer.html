<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualiseur d'Entra√Ænements - S06</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            margin-bottom: 10px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .week-info {
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .week-info h2 {
            color: #667eea;
            margin-bottom: 15px;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 15px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-card .number {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-card .label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .workout-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .workout-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }

        .workout-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .workout-title {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .workout-code {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 1.2em;
        }

        .workout-type {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
        }

        .workout-meta {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 15px;
            background: #f8f9fa;
            border-radius: 20px;
        }

        .meta-item .icon {
            font-size: 1.2em;
        }

        .intervals-section {
            margin-top: 20px;
        }

        .intervals-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .interval {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 15px;
            margin-bottom: 10px;
            border-radius: 8px;
        }

        .interval.warmup {
            border-left-color: #4CAF50;
        }

        .interval.work {
            border-left-color: #f44336;
        }

        .interval.recovery {
            border-left-color: #2196F3;
        }

        .interval-header {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .interval-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 10px;
            font-size: 0.9em;
            color: #666;
        }

        .interval-detail {
            display: flex;
            flex-direction: column;
        }

        .interval-detail .label {
            font-size: 0.8em;
            text-transform: uppercase;
            color: #999;
            margin-bottom: 3px;
        }

        .interval-detail .value {
            font-weight: 600;
            color: #333;
        }

        .series-item {
            background: #f8f9fa;
            padding: 12px;
            margin-bottom: 8px;
            border-radius: 6px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .series-item.tech {
            border-left: 4px solid #FF9800;
        }

        .series-number {
            background: #667eea;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.9em;
        }

        .tech-badge {
            background: #FF9800;
            color: white;
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: bold;
        }

        .notes {
            background: #fffbeb;
            border-left: 4px solid #f59e0b;
            padding: 15px;
            margin-top: 20px;
            border-radius: 8px;
        }

        .notes-title {
            font-weight: 600;
            color: #f59e0b;
            margin-bottom: 8px;
        }

        .distances-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 10px;
            margin-top: 15px;
        }

        .distance-card {
            background: #f8f9fa;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
        }

        .distance-card .stroke {
            font-size: 0.8em;
            color: #999;
            margin-bottom: 5px;
        }

        .distance-card .distance {
            font-size: 1.3em;
            font-weight: bold;
            color: #667eea;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .filter-btn {
            background: white;
            color: #667eea;
            border: 2px solid white;
            padding: 10px 25px;
            border-radius: 25px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            background: #667eea;
            color: white;
        }

        .filter-btn.active {
            background: white;
            color: #667eea;
            box-shadow: 0 5px 15px rgba(255,255,255,0.3);
        }

        .loading {
            text-align: center;
            color: white;
            font-size: 1.5em;
            padding: 50px;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2em;
            }

            .workout-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .interval-details {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üèãÔ∏è Visualiseur d'Entra√Ænements</h1>

        <div id="app">
            <div class="loading">‚è≥ Chargement des donn√©es...</div>
        </div>
    </div>

    <!-- Donn√©es embarqu√©es -->
    <script src="workout_data.js"></script>

    <script>
        function loadData() {
            try {
                // Les donn√©es sont directement disponibles via workout_data.js
                renderApp(WORKOUT_DATA);
            } catch (error) {
                document.getElementById('app').innerHTML = `
                    <div class="week-info">
                        <h2>‚ùå Erreur de chargement</h2>
                        <p>Impossible de charger les donn√©es : ${error.message}</p>
                    </div>
                `;
            }
        }

        function renderApp(data) {
            const app = document.getElementById('app');

            // Compter les s√©ances par discipline
            const disciplines = {};
            data.workouts.forEach(w => {
                disciplines[w.type] = (disciplines[w.type] || 0) + 1;
            });

            const html = `
                <div class="week-info">
                    <h2>üìÖ Semaine ${data.week} - ${data.period}</h2>
                    <div class="stats">
                        <div class="stat-card">
                            <div class="number">${data.workouts.length}</div>
                            <div class="label">Total S√©ances</div>
                        </div>
                        ${Object.entries(disciplines).map(([type, count]) => `
                            <div class="stat-card">
                                <div class="number">${count}</div>
                                <div class="label">${type}</div>
                            </div>
                        `).join('')}
                    </div>
                </div>

                <div class="filter-buttons">
                    <button class="filter-btn active" onclick="filterWorkouts('all')">Tous</button>
                    <button class="filter-btn" onclick="filterWorkouts('Cyclisme')">üö¥ Cyclisme</button>
                    <button class="filter-btn" onclick="filterWorkouts('Course √† pied')">üèÉ Course √† pied</button>
                    <button class="filter-btn" onclick="filterWorkouts('Natation')">üèä Natation</button>
                </div>

                <div id="workouts-container">
                    ${data.workouts.map(w => renderWorkout(w)).join('')}
                </div>
            `;

            app.innerHTML = html;
        }

        function renderWorkout(workout) {
            const icon = {
                'Cyclisme': 'üö¥',
                'Course √† pied': 'üèÉ',
                'Natation': 'üèä'
            }[workout.type] || 'üèãÔ∏è';

            return `
                <div class="workout-card" data-type="${workout.type}">
                    <div class="workout-header">
                        <div class="workout-title">
                            <span class="workout-code">${workout.code}</span>
                            <span class="workout-type">${icon} ${workout.type}</span>
                        </div>
                    </div>

                    <div class="workout-meta">
                        <div class="meta-item">
                            <span class="icon">üìÖ</span>
                            <span>${formatDate(workout.date)}</span>
                        </div>
                        <div class="meta-item">
                            <span class="icon">‚è±Ô∏è</span>
                            <span>${workout.duration_total || 'N/A'}</span>
                        </div>
                        ${workout.description ? `
                            <div class="meta-item">
                                <span class="icon">üìù</span>
                                <span>${workout.description}</span>
                            </div>
                        ` : ''}
                    </div>

                    ${workout.type === 'Cyclisme' ? renderCyclingIntervals(workout) : ''}
                    ${workout.type === 'Course √† pied' ? renderRunningIntervals(workout) : ''}
                    ${workout.type === 'Natation' ? renderSwimmingSeries(workout) : ''}

                    ${workout.notes ? `
                        <div class="notes">
                            <div class="notes-title">üí° Consignes</div>
                            <div>${workout.notes.substring(0, 300)}${workout.notes.length > 300 ? '...' : ''}</div>
                        </div>
                    ` : ''}
                </div>
            `;
        }

        function renderCyclingIntervals(workout) {
            if (!workout.intervals || workout.intervals.length === 0) return '';

            return `
                <div class="intervals-section">
                    <div class="intervals-title">
                        ‚ö° Intervalles (${workout.intervals.length})
                    </div>
                    ${workout.intervals.map((interval, idx) => `
                        <div class="interval ${getPhaseClass(interval.phase)}">
                            <div class="interval-header">
                                ${idx + 1}. ${interval.phase}${interval.position ? ` - ${interval.position}` : ''}
                            </div>
                            <div class="interval-details">
                                <div class="interval-detail">
                                    <span class="label">Dur√©e</span>
                                    <span class="value">${interval.duration}</span>
                                </div>
                                <div class="interval-detail">
                                    <span class="label">Cadence</span>
                                    <span class="value">${interval.cadence_rpm} rpm</span>
                                </div>
                                <div class="interval-detail">
                                    <span class="label">Puissance</span>
                                    <span class="value">${interval.power_watts} W</span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderRunningIntervals(workout) {
            if (!workout.intervals || workout.intervals.length === 0) return '';

            return `
                <div class="intervals-section">
                    <div class="intervals-title">
                        ‚ö° Intervalles (${workout.intervals.length})
                    </div>
                    ${workout.intervals.map((interval, idx) => `
                        <div class="interval ${getPhaseClass(interval.phase)}">
                            <div class="interval-header">
                                ${idx + 1}. ${interval.phase}
                            </div>
                            <div class="interval-details">
                                <div class="interval-detail">
                                    <span class="label">Dur√©e</span>
                                    <span class="value">${interval.duration}</span>
                                </div>
                                <div class="interval-detail">
                                    <span class="label">Allure</span>
                                    <span class="value">${interval.pace_min_per_km || interval.pace_description || 'N/A'}</span>
                                </div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            `;
        }

        function renderSwimmingSeries(workout) {
            if (!workout.series || workout.series.length === 0) return '';

            return `
                <div class="intervals-section">
                    <div class="intervals-title">
                        üèä S√©ries (${workout.series.length})
                    </div>
                    ${workout.series.map((serie, idx) => `
                        <div class="series-item ${serie.technique ? 'tech' : ''}">
                            <div class="series-number">${idx + 1}</div>
                            <div style="flex: 1;">
                                ${serie.description}
                                ${serie.technique ? `<span class="tech-badge">${serie.technique}</span>` : ''}
                            </div>
                        </div>
                    `).join('')}

                    ${renderSwimmingDistances(workout.distances)}
                </div>
            `;
        }

        function renderSwimmingDistances(distances) {
            if (!distances || Object.values(distances).every(d => d === 0)) return '';

            const nonZero = Object.entries(distances).filter(([_, dist]) => dist > 0);
            const total = nonZero.reduce((sum, [_, dist]) => sum + dist, 0);

            return `
                <div style="margin-top: 20px;">
                    <div class="intervals-title">üìä Distances par nage</div>
                    <div class="distances-grid">
                        ${nonZero.map(([stroke, dist]) => `
                            <div class="distance-card">
                                <div class="stroke">${stroke}</div>
                                <div class="distance">${dist}m</div>
                            </div>
                        `).join('')}
                        <div class="distance-card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                            <div class="stroke" style="color: rgba(255,255,255,0.8);">TOTAL</div>
                            <div class="distance">${total}m</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function getPhaseClass(phase) {
            if (phase.toLowerCase().includes('echauff')) return 'warmup';
            if (phase.toLowerCase().includes('r√©cup')) return 'recovery';
            if (phase.toLowerCase().includes('corps')) return 'work';
            return '';
        }

        function formatDate(dateStr) {
            if (!dateStr) return 'N/A';
            const date = new Date(dateStr);
            return date.toLocaleDateString('fr-FR', { weekday: 'long', day: 'numeric', month: 'long' });
        }

        function filterWorkouts(type) {
            // Mettre √† jour les boutons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');

            // Filtrer les cartes
            const cards = document.querySelectorAll('.workout-card');
            cards.forEach(card => {
                if (type === 'all' || card.dataset.type === type) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });
        }

        // Charger les donn√©es au d√©marrage
        loadData();
    </script>
</body>
</html>
